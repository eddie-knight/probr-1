{
  "Meta": {
    "group": "kubernetes"
  },
  "Path": "kubernetes\\audit\\podsecurity.json",
  "ScenariosAttempted": 19,
  "ScenariosSucceeded": 19,
  "ScenariosFailed": 0,
  "Result": "Success",
  "Scenarios": {
    "1": {
      "Name": "Prevent a deployment from running with privileged access",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-001"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"allowPrivilegeEscalation\" set to \"false\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110621-4198",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110621-4198",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110621-4198",
                "uid": "e166c785-b5f1-4986-8c30-f2aecf5d5394",
                "resourceVersion": "17502488",
                "creationTimestamp": "2021-05-07T15:06:21Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:06:21Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"fails\" with \"allowPrivilegeEscalation\" set to \"true\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation fails; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110621-3074",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": true
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "creationTimestamp": null
              },
              "spec": {
                "containers": null
              },
              "status": {}
            },
            "CreationError": {
              "ErrStatus": {
                "metadata": {},
                "status": "Failure",
                "message": "admission webhook \"validation.gatekeeper.sh\" denied the request: [denied by azurepolicy-psp-container-no-privilege-esc-91bacdb57bbbdf9becfd] Privilege escalation container is not allowed: podsecurity-probe-pod",
                "reason": "[denied by azurepolicy-psp-container-no-privilege-esc-91bacdb57bbbdf9becfd] Privilege escalation container is not allowed: podsecurity-probe-pod",
                "code": 403
              }
            }
          }
        }
      }
    },
    "10": {
      "Name": "Prevent a deployment from running with access to the host's network namespace",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-007"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"hostNetwork\" set to \"false\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110720-3314",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110720-3314",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110720-3314",
                "uid": "8c556937-3a8a-4f7e-b459-6e791299bf7b",
                "resourceVersion": "17502752",
                "creationTimestamp": "2021-05-07T15:07:20Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:07:20Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"fails\" with \"hostNetwork\" set to \"true\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation fails; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110720-9660",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "hostNetwork": true,
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "creationTimestamp": null
              },
              "spec": {
                "containers": null
              },
              "status": {}
            },
            "CreationError": {
              "ErrStatus": {
                "metadata": {},
                "status": "Failure",
                "message": "admission webhook \"validation.gatekeeper.sh\" denied the request: [denied by azurepolicy-psp-host-network-ports-8f4d0952305df3b6a0a4] The specified hostNetwork and hostPort are not allowed, pod: podsecurity-070521-110720-9660, container: podsecurity-probe-pod. Allowed values: {\"allowHostNetwork\": false, \"maxPort\": 0, \"minPort\": 0}",
                "reason": "[denied by azurepolicy-psp-host-network-ports-8f4d0952305df3b6a0a4] The specified hostNetwork and hostPort are not allowed, pod: podsecurity-070521-110720-9660, container: podsecurity-probe-pod. Allowed values: {\"allowHostNetwork\": false, \"maxPort\": 0, \"minPort\": 0}",
                "code": 403
              }
            }
          }
        }
      }
    },
    "11": {
      "Name": "Prevent execution of commands that allow access to the host's network namespace access",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-008"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"hostNetwork\" set to \"not have a value provided\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110720-6182",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110720-6182",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110720-6182",
                "uid": "4c186cda-2650-4415-8a23-9163bfa92d8b",
                "resourceVersion": "17502759",
                "creationTimestamp": "2021-05-07T15:07:20Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:07:20Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "thePodIPAndHostIPHaveDifferentValues",
          "Name": "the PodIP and HostIP have different values",
          "Description": "Retrieve IP values from created pod; Validate that PodIP and HostIP have different values; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "PodName": "podsecurity-070521-110720-6182",
            "PodIP": "10.240.0.30",
            "HostIP": "10.240.0.4"
          }
        }
      }
    },
    "12": {
      "Name": "Prevent execution of commands that allow access to the host's network namespace access",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-008"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"hostNetwork\" set to \"false\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110733-7676",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110733-7676",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110733-7676",
                "uid": "511f06be-de06-4ff3-812b-cf49600d6261",
                "resourceVersion": "17502804",
                "creationTimestamp": "2021-05-07T15:07:32Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:07:32Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "thePodIPAndHostIPHaveDifferentValues",
          "Name": "the PodIP and HostIP have different values",
          "Description": "Retrieve IP values from created pod; Validate that PodIP and HostIP have different values; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "PodName": "podsecurity-070521-110733-7676",
            "PodIP": "10.240.0.19",
            "HostIP": "10.240.0.4"
          }
        }
      }
    },
    "13": {
      "Name": "Prevent a deployment from running as the root user",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-009"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"user\" set to \"1000\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110741-7042",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110741-7042",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110741-7042",
                "uid": "0107719e-ae76-4a4f-a614-804de6c996ba",
                "resourceVersion": "17502844",
                "creationTimestamp": "2021-05-07T15:07:40Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:07:40Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"fails\" with \"user\" set to \"0\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation fails; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110741-2269",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 0,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "creationTimestamp": null
              },
              "spec": {
                "containers": null
              },
              "status": {}
            },
            "CreationError": {
              "ErrStatus": {
                "metadata": {},
                "status": "Failure",
                "message": "admission webhook \"validation.gatekeeper.sh\" denied the request: [denied by azurepolicy-psp-allowed-users-groups-8cc67aef7d87b246e1c9] Container podsecurity-probe-pod is attempting to run as disallowed user 0. Allowed runAsUser: {\"ranges\": [], \"rule\": \"MustRunAsNonRoot\"}",
                "reason": "[denied by azurepolicy-psp-allowed-users-groups-8cc67aef7d87b246e1c9] Container podsecurity-probe-pod is attempting to run as disallowed user 0. Allowed runAsUser: {\"ranges\": [], \"rule\": \"MustRunAsNonRoot\"}",
                "code": 403
              }
            }
          }
        }
      }
    },
    "14": {
      "Name": "Prevent usage of commands that require root permissions",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-010"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"user\" set to \"1000\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110741-1953",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110741-1953",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110741-1953",
                "uid": "40aeffc5-76ed-46aa-8d60-a6e101195260",
                "resourceVersion": "17502849",
                "creationTimestamp": "2021-05-07T15:07:41Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:07:41Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "theExecutionOfAXCommandInsideThePodIsY",
          "Name": "the execution of a \"root\" command inside the pod is \"unsuccessful\"",
          "Description": "Attempt to run a command in the pod that was created by the previous step; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "Command": "touch /dev/probr",
            "StdOut": "",
            "StdErr": "touch: /dev/probr: Permission denied\n",
            "ExitCode": 1,
            "ExpectedExitCode": 1
          }
        }
      }
    },
    "15": {
      "Name": "Ensure that the seccomp profile is set to docker/default in all pod definitions",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-011"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"annotations\" set to \"include seccomp profile\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110753-3750",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110753-3750",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110753-3750",
                "uid": "fd8880ce-4724-412d-b812-ef8036201c4d",
                "resourceVersion": "17502900",
                "creationTimestamp": "2021-05-07T15:07:52Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:07:52Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"fails\" with \"annotations\" set to \"not include seccomp profile\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation fails; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110753-4260",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "creationTimestamp": null
              },
              "spec": {
                "containers": null
              },
              "status": {}
            },
            "CreationError": {
              "ErrStatus": {
                "metadata": {},
                "status": "Failure",
                "message": "admission webhook \"validation.gatekeeper.sh\" denied the request: [denied by azurepolicy-psp-seccomp-a4904076f6e759e7748c] Seccomp profile is not allowed, pod: podsecurity-070521-110753-4260, container: podsecurity-probe-pod, Allowed profiles: [\"runtime/default\", \"docker/default\"]",
                "reason": "[denied by azurepolicy-psp-seccomp-a4904076f6e759e7748c] Seccomp profile is not allowed, pod: podsecurity-070521-110753-4260, container: podsecurity-probe-pod, Allowed profiles: [\"runtime/default\", \"docker/default\"]",
                "code": 403
              }
            }
          }
        }
      }
    },
    "16": {
      "Name": "Ensure that containers cannot deploy with the NET_RAW ability",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-012"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"fails\" with \"capabilities\" set to \"not have a value provided\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation fails; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110753-5416",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {},
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "creationTimestamp": null
              },
              "spec": {
                "containers": null
              },
              "status": {}
            },
            "CreationError": {
              "ErrStatus": {
                "metadata": {},
                "status": "Failure",
                "message": "admission webhook \"validation.gatekeeper.sh\" denied the request: [denied by azurepolicy-container-allowed-capabilities-dc17c4f7094e0e7bb36a] container \u003cpodsecurity-probe-pod\u003e is not dropping all required capabilities. Container must drop all of [\"NET_RAW\"]",
                "reason": "[denied by azurepolicy-container-allowed-capabilities-dc17c4f7094e0e7bb36a] container \u003cpodsecurity-probe-pod\u003e is not dropping all required capabilities. Container must drop all of [\"NET_RAW\"]",
                "code": 403
              }
            }
          }
        }
      }
    },
    "17": {
      "Name": "Ensure that containers cannot deploy with the NET_RAW ability",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-012"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"fails\" with \"capabilities\" set to \"add NET_RAW\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation fails; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110753-139",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "add": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "creationTimestamp": null
              },
              "spec": {
                "containers": null
              },
              "status": {}
            },
            "CreationError": {
              "ErrStatus": {
                "metadata": {},
                "status": "Failure",
                "message": "admission webhook \"validation.gatekeeper.sh\" denied the request: [denied by azurepolicy-container-allowed-capabilities-dc17c4f7094e0e7bb36a] container \u003cpodsecurity-probe-pod\u003e is not dropping all required capabilities. Container must drop all of [\"NET_RAW\"]\n[denied by azurepolicy-container-allowed-capabilities-dc17c4f7094e0e7bb36a] container \u003cpodsecurity-probe-pod\u003e has a disallowed capability. Allowed capabilities are [\"NET_ADMIN\"]",
                "reason": "[denied by azurepolicy-container-allowed-capabilities-dc17c4f7094e0e7bb36a] container \u003cpodsecurity-probe-pod\u003e is not dropping all required capabilities. Container must drop all of [\"NET_RAW\"]\n[denied by azurepolicy-container-allowed-capabilities-dc17c4f7094e0e7bb36a] container \u003cpodsecurity-probe-pod\u003e has a disallowed capability. Allowed capabilities are [\"NET_ADMIN\"]",
                "code": 403
              }
            }
          }
        }
      }
    },
    "18": {
      "Name": "Ensure that containers cannot deploy with the NET_RAW ability",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-012"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"capabilities\" set to \"drop NET_RAW\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110753-4247",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110753-4247",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110753-4247",
                "uid": "43e715ff-8e9d-432e-8a0e-f21c13d6c213",
                "resourceVersion": "17502905",
                "creationTimestamp": "2021-05-07T15:07:53Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:07:53Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        }
      }
    },
    "19": {
      "Name": "Ensure that containers are not permitted to use ping",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-013"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"capabilities\" set to \"drop NET_RAW\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110753-8556",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110753-8556",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110753-8556",
                "uid": "cbbafe58-2bb2-47d7-8ff4-30f0df584fa6",
                "resourceVersion": "17502912",
                "creationTimestamp": "2021-05-07T15:07:53Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:07:53Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "theExecutionOfAXCommandInsideThePodIsY",
          "Name": "the execution of a \"ping\" command inside the pod is \"unsuccessful\"",
          "Description": "Attempt to run a command in the pod that was created by the previous step; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "Command": "ping google.com",
            "StdOut": "",
            "StdErr": "ping: bad address 'google.com'\n",
            "ExitCode": 1,
            "ExpectedExitCode": 1
          }
        }
      }
    },
    "2": {
      "Name": "Prevent execution of commands that require privileged access",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-002"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"allowPrivilegeEscalation\" set to \"not have a value provided\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110621-3244",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110621-3244",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110621-3244",
                "uid": "ae8c44af-b52e-41f2-bd7e-2eb01c1aaf76",
                "resourceVersion": "17502493",
                "creationTimestamp": "2021-05-07T15:06:21Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:06:21Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "theExecutionOfAXCommandInsideThePodIsY",
          "Name": "the execution of a \"non-privileged\" command inside the pod is \"successful\"",
          "Description": "Attempt to run a command in the pod that was created by the previous step; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "Command": "ls",
            "StdOut": "bin\ndev\netc\nhome\nlib\nmedia\nmnt\nopt\nproc\nroot\nrun\nsbin\nsrv\nsys\ntmp\nusr\nvar\n",
            "StdErr": "",
            "ExitCode": -1,
            "ExpectedExitCode": 0
          }
        },
        "4": {
          "Function": "theExecutionOfAXCommandInsideThePodIsY",
          "Name": "the execution of a \"privileged\" command inside the pod is \"prevented by restricted permissions\"",
          "Description": "Attempt to run a command in the pod that was created by the previous step; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "Command": "mount /fake /fake",
            "StdOut": "",
            "StdErr": "mount: /fake: must be superuser to use mount.\n",
            "ExitCode": 32,
            "ExpectedExitCode": 32
          }
        }
      }
    },
    "3": {
      "Name": "Prevent execution of commands that require privileged access",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-002"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"allowPrivilegeEscalation\" set to \"false\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110643-9127",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110643-9127",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110643-9127",
                "uid": "4ee34e62-02e6-4699-b639-3acb6795ddca",
                "resourceVersion": "17502572",
                "creationTimestamp": "2021-05-07T15:06:43Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:06:43Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "theExecutionOfAXCommandInsideThePodIsY",
          "Name": "the execution of a \"non-privileged\" command inside the pod is \"successful\"",
          "Description": "Attempt to run a command in the pod that was created by the previous step; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "Command": "ls",
            "StdOut": "bin\ndev\netc\nhome\nlib\nmedia\nmnt\nopt\nproc\nroot\nrun\nsbin\nsrv\nsys\ntmp\nusr\nvar\n",
            "StdErr": "",
            "ExitCode": -1,
            "ExpectedExitCode": 0
          }
        },
        "4": {
          "Function": "theExecutionOfAXCommandInsideThePodIsY",
          "Name": "the execution of a \"privileged\" command inside the pod is \"prevented by restricted permissions\"",
          "Description": "Attempt to run a command in the pod that was created by the previous step; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "Command": "mount /fake /fake",
            "StdOut": "",
            "StdErr": "mount: /fake: must be superuser to use mount.\n",
            "ExitCode": 32,
            "ExpectedExitCode": 32
          }
        }
      }
    },
    "4": {
      "Name": "Prevent a deployment from running in the host's process tree namespace",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-003"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"hostPID\" set to \"false\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110654-5290",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110654-5290",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110654-5290",
                "uid": "54b9dd3d-bd3e-4aa1-8cdc-3e16340b9d36",
                "resourceVersion": "17502614",
                "creationTimestamp": "2021-05-07T15:06:53Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:06:53Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"fails\" with \"hostPID\" set to \"true\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation fails; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110654-948",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "hostPID": true,
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "creationTimestamp": null
              },
              "spec": {
                "containers": null
              },
              "status": {}
            },
            "CreationError": {
              "ErrStatus": {
                "metadata": {},
                "status": "Failure",
                "message": "admission webhook \"validation.gatekeeper.sh\" denied the request: [denied by azurepolicy-psp-host-namespace-e8fb7d84fb6e5a9798b1] Sharing the host namespace is not allowed: podsecurity-070521-110654-948",
                "reason": "[denied by azurepolicy-psp-host-namespace-e8fb7d84fb6e5a9798b1] Sharing the host namespace is not allowed: podsecurity-070521-110654-948",
                "code": 403
              }
            }
          }
        }
      }
    },
    "5": {
      "Name": "Prevent execution of commands that allow privileged access",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-004"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"hostPID\" set to \"not have a value provided\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110654-3319",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110654-3319",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110654-3319",
                "uid": "4c9ccffe-e2cb-4098-8ff4-b87060028fe3",
                "resourceVersion": "17502623",
                "creationTimestamp": "2021-05-07T15:06:53Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:06:53Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "theExecutionOfAXCommandInsideThePodIsY",
          "Name": "the execution of a \"non-privileged\" command inside the pod is \"successful\"",
          "Description": "Attempt to run a command in the pod that was created by the previous step; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "Command": "ls",
            "StdOut": "bin\ndev\netc\nhome\nlib\nmedia\nmnt\nopt\nproc\nroot\nrun\nsbin\nsrv\nsys\ntmp\nusr\nvar\n",
            "StdErr": "",
            "ExitCode": -1,
            "ExpectedExitCode": 0
          }
        },
        "4": {
          "Function": "aXInspectionShouldOnlyShowTheContainerProcesses",
          "Name": "a \"process\" inspection should only show the container processes",
          "Description": "",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "Command": "ps",
            "ExitCode": -1,
            "Stdout": "PID   USER     TIME  COMMAND\n    1 1000      0:00 sleep 3600\n   12 1000      0:00 ps\n",
            "Entrypoint": "sleep 3600"
          }
        }
      }
    },
    "6": {
      "Name": "Prevent execution of commands that allow privileged access",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-004"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"hostPID\" set to \"false\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110703-4813",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110703-4813",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110703-4813",
                "uid": "06b9f2a0-b6ca-4bdc-bea9-1ef44ab0452c",
                "resourceVersion": "17502663",
                "creationTimestamp": "2021-05-07T15:07:03Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:07:03Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "theExecutionOfAXCommandInsideThePodIsY",
          "Name": "the execution of a \"non-privileged\" command inside the pod is \"successful\"",
          "Description": "Attempt to run a command in the pod that was created by the previous step; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "Command": "ls",
            "StdOut": "bin\ndev\netc\nhome\nlib\nmedia\nmnt\nopt\nproc\nroot\nrun\nsbin\nsrv\nsys\ntmp\nusr\nvar\n",
            "StdErr": "",
            "ExitCode": -1,
            "ExpectedExitCode": 0
          }
        },
        "4": {
          "Function": "aXInspectionShouldOnlyShowTheContainerProcesses",
          "Name": "a \"process\" inspection should only show the container processes",
          "Description": "",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "Command": "ps",
            "ExitCode": -1,
            "Stdout": "PID   USER     TIME  COMMAND\n    1 1000      0:00 sleep 3600\n   11 1000      0:00 ps\n",
            "Entrypoint": "sleep 3600"
          }
        }
      }
    },
    "7": {
      "Name": "Prevent a deployment from running with access to the shared host IPC namespace",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-005"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"hostIPC\" set to \"false\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110706-9590",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110706-9590",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110706-9590",
                "uid": "6241c6ae-81e1-47cc-8694-6fa48f3a232c",
                "resourceVersion": "17502681",
                "creationTimestamp": "2021-05-07T15:07:05Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:07:05Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"fails\" with \"hostIPC\" set to \"true\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation fails; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110706-9317",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "hostIPC": true,
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "creationTimestamp": null
              },
              "spec": {
                "containers": null
              },
              "status": {}
            },
            "CreationError": {
              "ErrStatus": {
                "metadata": {},
                "status": "Failure",
                "message": "admission webhook \"validation.gatekeeper.sh\" denied the request: [denied by azurepolicy-psp-host-namespace-e8fb7d84fb6e5a9798b1] Sharing the host namespace is not allowed: podsecurity-070521-110706-9317",
                "reason": "[denied by azurepolicy-psp-host-namespace-e8fb7d84fb6e5a9798b1] Sharing the host namespace is not allowed: podsecurity-070521-110706-9317",
                "code": 403
              }
            }
          }
        }
      }
    },
    "8": {
      "Name": "Prevent a deployment from running with access to the shared host IPC namespace",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-006"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"hostIPC\" set to \"not have a value provided\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110706-1450",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110706-1450",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110706-1450",
                "uid": "3598cc6d-d9b4-44ab-82e2-dbfbed34f3e2",
                "resourceVersion": "17502688",
                "creationTimestamp": "2021-05-07T15:07:06Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:07:06Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "theExecutionOfAXCommandInsideThePodIsY",
          "Name": "the execution of a \"non-privileged\" command inside the pod is \"successful\"",
          "Description": "Attempt to run a command in the pod that was created by the previous step; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "Command": "ls",
            "StdOut": "bin\ndev\netc\nhome\nlib\nmedia\nmnt\nopt\nproc\nroot\nrun\nsbin\nsrv\nsys\ntmp\nusr\nvar\n",
            "StdErr": "",
            "ExitCode": -1,
            "ExpectedExitCode": 0
          }
        },
        "4": {
          "Function": "aXInspectionShouldOnlyShowTheContainerProcesses",
          "Name": "a \"namespace\" inspection should only show the container processes",
          "Description": "",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "Command": "lsns -n",
            "ExitCode": -1,
            "Stdout": "4026531835 cgroup      2   1 1000 sleep 3600\n4026531837 user        2   1 1000 sleep 3600\n4026534026 ipc         2   1 1000 sleep 3600\n4026534029 net         2   1 1000 sleep 3600\n4026534102 mnt         2   1 1000 sleep 3600\n4026534103 uts         2   1 1000 sleep 3600\n4026534104 pid         2   1 1000 sleep 3600\n",
            "Entrypoint": "sleep 3600"
          }
        }
      }
    },
    "9": {
      "Name": "Prevent a deployment from running with access to the shared host IPC namespace",
      "Result": "Passed",
      "Tags": [
        "@k-pod",
        "@probes/kubernetes/pod",
        "@k-pod-006"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationResultsWithXSetToYInThePodSpec",
          "Name": "pod creation \"succeeds\" with \"hostIPC\" set to \"false\" in the pod spec",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "podsecurity-070521-110709-912",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "CreatedPod": {
              "metadata": {
                "name": "podsecurity-070521-110709-912",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/podsecurity-070521-110709-912",
                "uid": "0ce62b33-5647-4d0d-b5ae-3d5a134c4afc",
                "resourceVersion": "17502709",
                "creationTimestamp": "2021-05-07T15:07:09Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:07:09Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"podsecurity-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "podsecurity-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "theExecutionOfAXCommandInsideThePodIsY",
          "Name": "the execution of a \"non-privileged\" command inside the pod is \"successful\"",
          "Description": "Attempt to run a command in the pod that was created by the previous step; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "Command": "ls",
            "StdOut": "bin\ndev\netc\nhome\nlib\nmedia\nmnt\nopt\nproc\nroot\nrun\nsbin\nsrv\nsys\ntmp\nusr\nvar\n",
            "StdErr": "",
            "ExitCode": -1,
            "ExpectedExitCode": 0
          }
        },
        "4": {
          "Function": "aXInspectionShouldOnlyShowTheContainerProcesses",
          "Name": "a \"namespace\" inspection should only show the container processes",
          "Description": "",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "Command": "lsns -n",
            "ExitCode": -1,
            "Stdout": "4026531835 cgroup      2   1 1000 sleep 3600\n4026531837 user        2   1 1000 sleep 3600\n4026533578 ipc         2   1 1000 sleep 3600\n4026533581 net         2   1 1000 sleep 3600\n4026533649 mnt         2   1 1000 sleep 3600\n4026533650 uts         2   1 1000 sleep 3600\n4026533651 pid         2   1 1000 sleep 3600\n",
            "Entrypoint": "sleep 3600"
          }
        }
      }
    }
  }
}