{
  "Meta": {
    "group": "kubernetes"
  },
  "Path": "kubernetes\\audit\\general.json",
  "ScenariosAttempted": 5,
  "ScenariosSucceeded": 4,
  "ScenariosFailed": 1,
  "Result": "Failed",
  "Scenarios": {
    "1": {
      "Name": "Ensure Kubernetes Web UI is disabled",
      "Result": "Passed",
      "Tags": [
        "@k-gen",
        "@probes/kubernetes/general",
        "@k-gen-001"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "theKubernetesWebUIIsDisabled",
          "Name": "the Kubernetes Web UI is disabled",
          "Description": "Attempt to find a pod in the 'kube-system' namespace with the prefix 'kubernetes-dashboard'; Get all pods from 'kube-system' namespace; Confirm a pod with 'kubernetes-dashboard' prefix doesn't exist; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeSystemNamespace": "kube-system",
            "DashboardPodNamePrefix": "kubernetes-dashboard"
          }
        }
      }
    },
    "2": {
      "Name": "Test outgoing connectivity of a deployed pod",
      "Result": "Passed",
      "Tags": [
        "@k-gen",
        "@probes/kubernetes/general",
        "@k-gen-002"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationInNamespace",
          "Name": "pod creation \"succeeds\" in the \"probr\" namespace",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "general-070521-110558-2542",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "general-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "Namespace": "probr-general-test-ns",
            "ExpectedResult": "succeeds",
            "CreatedPod": {
              "metadata": {
                "name": "general-070521-110558-2542",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/general-070521-110558-2542",
                "uid": "c7399452-4105-43cb-a880-b315fd04c926",
                "resourceVersion": "17502390",
                "creationTimestamp": "2021-05-07T15:05:58Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:05:58Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"general-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "general-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "theResultOfAProcessInsideThePodEstablishingADirectHTTPConnectionToXIsY",
          "Name": "the result of a process inside the pod establishing a direct http(s) connection to \"http://www.google.com\" is \"blocked\"",
          "Description": "Attempt to run command in the pod: 'curl -s -o /dev/null -I -L -w %{http_code} http://www.google.com'; Check expected exit code was raised from curl command; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "PodName": "general-070521-110558-2542",
            "Namespace": "probr-general-test-ns",
            "Command": "curl -s -o /dev/null -I -L -w %{http_code} http://www.google.com",
            "ExpectedCurlExitCode": 6,
            "CurlExitCode": 6,
            "StdOut": "000"
          }
        }
      }
    },
    "3": {
      "Name": "Test outgoing connectivity of a deployed pod",
      "Result": "Passed",
      "Tags": [
        "@k-gen",
        "@probes/kubernetes/general",
        "@k-gen-002"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationInNamespace",
          "Name": "pod creation \"succeeds\" in the \"probr\" namespace",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "general-070521-110606-5720",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "general-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "Namespace": "probr-general-test-ns",
            "ExpectedResult": "succeeds",
            "CreatedPod": {
              "metadata": {
                "name": "general-070521-110606-5720",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/general-070521-110606-5720",
                "uid": "12168315-2eb6-4092-8e0b-b026a3baee0f",
                "resourceVersion": "17502421",
                "creationTimestamp": "2021-05-07T15:06:06Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:06:06Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"general-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "general-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "theResultOfAProcessInsideThePodEstablishingADirectHTTPConnectionToXIsY",
          "Name": "the result of a process inside the pod establishing a direct http(s) connection to \"http://www.microsoft.com\" is \"blocked\"",
          "Description": "Attempt to run command in the pod: 'curl -s -o /dev/null -I -L -w %{http_code} http://www.microsoft.com'; Check expected exit code was raised from curl command; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "PodName": "general-070521-110606-5720",
            "Namespace": "probr-general-test-ns",
            "Command": "curl -s -o /dev/null -I -L -w %{http_code} http://www.microsoft.com",
            "ExpectedCurlExitCode": 6,
            "CurlExitCode": 6,
            "StdOut": "000"
          }
        }
      }
    },
    "4": {
      "Name": "Test outgoing connectivity of a deployed pod",
      "Result": "Passed",
      "Tags": [
        "@k-gen",
        "@probes/kubernetes/general",
        "@k-gen-002"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationInNamespace",
          "Name": "pod creation \"succeeds\" in the \"probr\" namespace",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "general-070521-110613-9877",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "general-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "Namespace": "probr-general-test-ns",
            "ExpectedResult": "succeeds",
            "CreatedPod": {
              "metadata": {
                "name": "general-070521-110613-9877",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/general-070521-110613-9877",
                "uid": "ce577808-46e2-4e78-ae70-d1378feb655a",
                "resourceVersion": "17502451",
                "creationTimestamp": "2021-05-07T15:06:13Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:06:13Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"general-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "general-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "theResultOfAProcessInsideThePodEstablishingADirectHTTPConnectionToXIsY",
          "Name": "the result of a process inside the pod establishing a direct http(s) connection to \"http://www.ubuntu.com\" is \"blocked\"",
          "Description": "Attempt to run command in the pod: 'curl -s -o /dev/null -I -L -w %{http_code} http://www.ubuntu.com'; Check expected exit code was raised from curl command; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "PodName": "general-070521-110613-9877",
            "Namespace": "probr-general-test-ns",
            "Command": "curl -s -o /dev/null -I -L -w %{http_code} http://www.ubuntu.com",
            "ExpectedCurlExitCode": 6,
            "CurlExitCode": 6,
            "StdOut": "000"
          }
        }
      }
    },
    "5": {
      "Name": "The default namespace should not be used",
      "Result": "Failed",
      "Tags": [
        "@k-gen",
        "@probes/kubernetes/general",
        "@k-gen-003"
      ],
      "Steps": {
        "1": {
          "Function": "aKubernetesClusterIsDeployed",
          "Name": "a Kubernetes cluster exists which we can deploy into",
          "Description": "Validate that a cluster can be reached using the specified kube config and context; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "KubeConfigPath": "C:\\Users\\eknight\\.kube\\config",
            "KubeContext": ""
          }
        },
        "2": {
          "Function": "podCreationInNamespace",
          "Name": "pod creation \"succeeds\" in the \"probr\" namespace",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation succeeds; ",
          "Result": "Passed",
          "Error": "",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "general-070521-110621-2453",
                "namespace": "probr-general-test-ns",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "general-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "Namespace": "probr-general-test-ns",
            "ExpectedResult": "succeeds",
            "CreatedPod": {
              "metadata": {
                "name": "general-070521-110621-2453",
                "namespace": "probr-general-test-ns",
                "selfLink": "/api/v1/namespaces/probr-general-test-ns/pods/general-070521-110621-2453",
                "uid": "af82d795-6819-40f2-b4d7-b2e9f3874aec",
                "resourceVersion": "17502478",
                "creationTimestamp": "2021-05-07T15:06:20Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:06:20Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"general-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-kgqdz",
                    "secret": {
                      "secretName": "default-token-kgqdz",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "general-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-kgqdz",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        },
        "3": {
          "Function": "podCreationInNamespace",
          "Name": "pod creation \"fails\" in the \"default\" namespace",
          "Description": "Build a pod spec with default values; Create pod from spec; Validate pod creation fails; ",
          "Result": "Failed",
          "Error": "Pod creation in namespace 'default' succeeded but should have failed",
          "Payload": {
            "RequestedPod": {
              "metadata": {
                "name": "general-070521-110621-1149",
                "namespace": "default",
                "creationTimestamp": null,
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                }
              },
              "spec": {
                "containers": [
                  {
                    "name": "general-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                }
              },
              "status": {}
            },
            "Namespace": "default",
            "ExpectedResult": "fails",
            "CreatedPod": {
              "metadata": {
                "name": "general-070521-110621-1149",
                "namespace": "default",
                "selfLink": "/api/v1/namespaces/default/pods/general-070521-110621-1149",
                "uid": "beb8d797-dd6d-45a4-b556-b30b389ddfd0",
                "resourceVersion": "17502482",
                "creationTimestamp": "2021-05-07T15:06:20Z",
                "labels": {
                  "app": "probr-probe"
                },
                "annotations": {
                  "seccomp.security.alpha.kubernetes.io/pod": "runtime/default"
                },
                "managedFields": [
                  {
                    "manager": "kubernetes.exe",
                    "operation": "Update",
                    "apiVersion": "v1",
                    "time": "2021-05-07T15:06:20Z",
                    "fieldsType": "FieldsV1",
                    "fieldsV1": {
                      "f:metadata": {
                        "f:annotations": {
                          ".": {},
                          "f:seccomp.security.alpha.kubernetes.io/pod": {}
                        },
                        "f:labels": {
                          ".": {},
                          "f:app": {}
                        }
                      },
                      "f:spec": {
                        "f:containers": {
                          "k:{\"name\":\"general-probe-pod\"}": {
                            ".": {},
                            "f:command": {},
                            "f:image": {},
                            "f:imagePullPolicy": {},
                            "f:name": {},
                            "f:resources": {},
                            "f:securityContext": {
                              ".": {},
                              "f:allowPrivilegeEscalation": {},
                              "f:capabilities": {
                                ".": {},
                                "f:drop": {}
                              },
                              "f:privileged": {}
                            },
                            "f:terminationMessagePath": {},
                            "f:terminationMessagePolicy": {}
                          }
                        },
                        "f:dnsPolicy": {},
                        "f:enableServiceLinks": {},
                        "f:nodeSelector": {
                          ".": {},
                          "f:kubernetes.io/os": {}
                        },
                        "f:restartPolicy": {},
                        "f:schedulerName": {},
                        "f:securityContext": {
                          ".": {},
                          "f:fsGroup": {},
                          "f:runAsGroup": {},
                          "f:runAsUser": {},
                          "f:supplementalGroups": {}
                        },
                        "f:terminationGracePeriodSeconds": {}
                      }
                    }
                  }
                ]
              },
              "spec": {
                "volumes": [
                  {
                    "name": "default-token-f8rbk",
                    "secret": {
                      "secretName": "default-token-f8rbk",
                      "defaultMode": 420
                    }
                  }
                ],
                "containers": [
                  {
                    "name": "general-probe-pod",
                    "image": "citihubprod.azurecr.io/citihub/probr-probe",
                    "command": [
                      "sleep",
                      "3600"
                    ],
                    "resources": {},
                    "volumeMounts": [
                      {
                        "name": "default-token-f8rbk",
                        "readOnly": true,
                        "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"
                      }
                    ],
                    "terminationMessagePath": "/dev/termination-log",
                    "terminationMessagePolicy": "File",
                    "imagePullPolicy": "IfNotPresent",
                    "securityContext": {
                      "capabilities": {
                        "drop": [
                          "NET_RAW"
                        ]
                      },
                      "privileged": false,
                      "allowPrivilegeEscalation": false
                    }
                  }
                ],
                "restartPolicy": "Always",
                "terminationGracePeriodSeconds": 30,
                "dnsPolicy": "ClusterFirst",
                "nodeSelector": {
                  "kubernetes.io/os": "linux"
                },
                "serviceAccountName": "default",
                "serviceAccount": "default",
                "securityContext": {
                  "runAsUser": 1000,
                  "runAsGroup": 3000,
                  "supplementalGroups": [
                    1
                  ],
                  "fsGroup": 2000
                },
                "schedulerName": "default-scheduler",
                "tolerations": [
                  {
                    "key": "node.kubernetes.io/not-ready",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  },
                  {
                    "key": "node.kubernetes.io/unreachable",
                    "operator": "Exists",
                    "effect": "NoExecute",
                    "tolerationSeconds": 300
                  }
                ],
                "priority": 0,
                "enableServiceLinks": true
              },
              "status": {
                "phase": "Pending",
                "qosClass": "BestEffort"
              }
            },
            "CreationError": null
          }
        }
      }
    }
  }
}